# GeneralizedCoarseGraining

Generalized Coarse Graining (GCG) enables the recursive coarse graining of 
discrete energy landscapes.

# `genCG.pl`

The Perl script `genCG.pl` computes the gradient-based coarse graining of a
given energy landscape encoding as produced by the 
[`barriers`](https://github.com/ViennaRNA/Barriers) tool when enabling
full rate computation activated by its `--rates` argument.

### RNA example

The following call set exemplifies the usage of `genCG.pl` for RNA secondary
structure energy landscapes using the 
[Vienna RNA package](https://github.com/ViennaRNA/ViennaRNA). 
*Note*, the calls are only viable for very short sequences since the whole
accessible structure space / energy landscape is considered. 

```[bash]
# define RNA sequence of interest
RNA=GGGGGAAACCCCUUUU

# enumerate (and sort) all secondary structures (first by energy using structure string for tie breaking)
echo $RNA | RNAsubopt --deltaEnergy=99999 | sort -k 2,2n -k 1,1dr -S 2G | zip $RNA.RNAsubopt.zip -;

# run barriers to compute coarse graining level 1
unzip -p $RNA.RNAsubopt.zip | barriers --rates -G RNA -M noShift --bsize --max=999999 --minh=0 > $RNA.barriers.out;
# store rate matrix generated by barriers
mv rates.out $RNA.barriers.rates;
# cleanup obsolete barriers files
rm -f rates.bin tree.ps treeR.ps;

# get micro-state landscape size
printf "#states level 0 = ";unzip -p $RNA.RNAsubopt.zip | grep -c -v $RNA;
# compute generalized coarse grainings
perl genCG.pl $RNA.barriers.out $RNA.barriers.rates

```

The calls produce the final `genCG.pl` output
```[bash]
#states level 0 = 1656
#states level 1 = 38
#states level 2 = 6
#states level 3 = 1
```
which states the number of macro-states on each coarse graining level.
Furthermore, the following files for each coarse graining level (`LVL`) > 1 are generated:
- `*.LVL.gradient` : appends an additional column to the `barriers` output file of the compressed level (`LVL-1`), which contains the gradient assignment for each local minimum
- `*.LVL.barriers` : a dummy `barriers` output file for the current level
- `*.LVL.rates` : the rates matrix for the current level

